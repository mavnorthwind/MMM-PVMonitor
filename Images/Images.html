<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Battery Charge / Discharge Demo</title>
    <style>

    </style>
</head>
<body style="background-color: blue; color: white;">

    <h3>Loaded as object</h3>
    <p>
        <div style="background-color: black;">
         <object id="batteryObj"
                 data="Battery.svg"
                 type="image/svg+xml"
                 style="width: 120px; margin-top: 4px; margin-left: 4px;"></object>
        </div>
    </p>
    <p>
        <button onclick="updateBattery(0)">0%</button>
        <button onclick="updateBattery(10)">10%</button>
        <button onclick="updateBattery(20)">20%</button>
        <button onclick="updateBattery(40)">40%</button>
        <button onclick="updateBattery(75)">75%</button>
        <button onclick="updateBattery(100)">100%</button>
    </p>
    <p>
        <button onclick="toggleDir()">Toggle direction</button>
    </p>
    <p>
        <button onclick="updateSpeed('3s')">Slow animation</button>
        <button onclick="updateSpeed('1s')">Fast animation</button>
    </p>
    <script>

        // Not needed anymore
        // async function loadSvg(container) {
        //     const el = document.getElementById(container);

        //     try{
        //         const resp = await fetch(el.dataset.src);
        //         const svgText = await resp.text();
        //         // For debugging only: delay actual loading by 2 seconds
        //         //await new Promise(resolve => setTimeout(resolve, 2000));
        //         el.innerHTML = svgText;
        //     } catch (err) {
        //         console.error("Could not load content:", err);
        //         el.textContent = "Sorry, could not load content.";
        //     }
        //     return el;
        // };

        function updateSpeed(spd) {
            const obj = document.getElementById("batteryObj");
            const svgDoc = obj.getSVGDocument();
            const svg = svgDoc.getElementById("socSvg");
            svg.setAttribute("data-speed", spd);
        }

        function toggleDir() {
            const obj = document.getElementById("batteryObj");
            const svgDoc = obj.getSVGDocument();
            const svg = svgDoc.getElementById("socSvg");
            var dir = svg.getAttribute("data-direction");
            if (dir == "ltr")
                svg.setAttribute("data-direction", "rtl");
            else
                svg.setAttribute("data-direction", "ltr");
        }

        function updateBattery(p) {
            const obj = document.getElementById("batteryObj");
            const svgDoc = obj.getSVGDocument();
            const svg = svgDoc.getElementById("socSvg");
            svg.setAttribute("data-fill", p);
        }

        document.getElementById('batteryObj').addEventListener('load', () => {
             updateBattery(55);
        });
    </script>
</body>
</html>